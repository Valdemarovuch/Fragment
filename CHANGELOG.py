#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
Fragment v2.0 - Додані функції SecureShredder
Профессиональна утиліта для контрольованого пошкодження і безпечного видалення файлів

ЗМІНИ В ПРОЕКТІ:
================

✨ НОВИЙ МОДУЛЬ: secure_delete.py
   - Клас SecureShredder для безпечного видалення
   - DoD 5220.22-M стандарт (нулі → одиниці → випадок)
   - Затирання метаданих MFT через перейменування
   - Статистика операцій (розмір, час, успіх)
   - Повне логування всіх проходів

🎯 РОЗШИРЕННЯ: config.py
   + OperationMode (CORRUPT, SECURE_DELETE)
   + DeletionMode (QUICK, STANDARD, EXTENDED)

🖥️  ОНОВЛЕННЯ GUI: gui.py
   + Динамічні контролі на основі режиму операції
   + Dropdown для вибору Operation (Corrupt/Delete)
   + Параметри для Secure Delete (режим + кількість проходів)
   + Окремі обробники для обох режимів
   + Окремі звіти про завершення для кожного режиму

📚 НОВІ ФАЙЛИ ДОКУМЕНТАЦІЇ:
   + SECURE_DELETE_GUIDE.md - детальна інструкція
   + test_modes.py - автоматичні тести обох режимів

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

АРХІТЕКТУРА:
============

┌─────────────────────────────────────────────────┐
│                    GUI (gui.py)                  │
│  ┌──────────────────┬──────────────────────────┐ │
│  │  Operation Menu  │  Corruption Controls    │ │
│  │  - Corrupt       │  - Mode selector        │ │
│  │  - Secure Delete │  - Naming patterns      │ │
│  │                  │  - Output directory     │ │
│  └──────────────────┼──────────────────────────┘ │
│  ┌──────────────────┬──────────────────────────┐ │
│  │ Delete Controls  │  Statistics             │ │
│  │ - Mode selector  │  - For Corruption       │ │
│  │ - Pass spinner   │  - For Secure Delete    │ │
│  └──────────────────┴──────────────────────────┘ │
└─────────────────────────────────────────────────┘
              ↓                    ↓
    ┌───────────────┐    ┌──────────────────┐
    │ Corruption    │    │ SecureShredder   │
    │ Engine        │    │ (DoD 5220.22-M) │
    └───────────────┘    └──────────────────┘
        ↓                        ↓
    ┌─────────────────────────────────────┐
    │  Logging (fragment_corruptor.log)   │
    └─────────────────────────────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

РЕЖИМ 1: CORRUPTION
====================

Мета: Тестування обробки пошкоджених файлів

Методи:
  1. Header Overwrite - заміна перших N байт
  2. Noise (Bit Flipping) - інверсія випадкових байтів
  3. Truncate - видалення кінця файлу
  4. Full Destruction - комбінація всіх трьох
  5. Custom - власні параметри

Особливості:
  ✓ Копіює оригінальний файл
  ✓ Пошкоджує копію
  ✓ КОПІЮЄ МЕТАДАНІ з оригіналу (неможливо розпізнати, що це копія)
  ✓ Гарантує, що результат виглядає як оригінал

Метадані, що копіюються:
  - Системні (дати створення, модифікації, доступу)
  - Office XML (docx/xlsx/pptx: автор, компанія, версія)
  - EXIF (зображення)
  - Windows creation time (якщо pywin32 встановлено)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

РЕЖИМ 2: SECURE DELETE
======================

Мета: Безпечне видалення конфіденційних даних

Алгоритм DoD 5220.22-M:

  Прохід 1: Запис всіх нулів (0x00) на весь файл
  Прохід 2: Запис всіх одиниць (0xFF) на весь файл
  Прохід 3: Запис випадкових даних (КРИТИЧНО!)
  [Проходи 4+: Повтор для Extended режиму]

  Затирання метаданих MFT:
  - Перейменування 3 рази з випадковими іменами
  - Це затирає сліди в файловій таблиці

  Видалення:
  - Остаточне видалення файлу

Рівні безпеки:

  1️⃣  QUICK (1 прохід)
      Проходи: Випадок
      Для: Непомітні дані, швидкість важлива
      Час: Найшвидший

  2️⃣  STANDARD (3 проходи) - Рекомендується
      Проходи: Нулі → Одиниці → Випадок
      Для: DoD стандарт, більшість сценаріїв
      Час: Розумний

  3️⃣  EXTENDED (7+ проходів)
      Проходи: DoD + Gutmann розширення
      Для: Критичні секрети, максимальна безпека
      Час: Повільніше, але максимально надійно

Гарантія:
  ✓ Дані фізично перезаписуються на диску
  ✓ Метадані затираються на рівні ОС
  ✓ Стандартні утиліти НЕ можуть відновити
  ✓ Навіть спеціалізовані програми майже неспроможні

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

СЦЕНАРІЇ ВИКОРИСТАННЯ:
======================

🔴 Corruption режим:
   • Тестування програм при восстановленні даних
   • Імітація пошкоджених архівів для тестів
   • Відладка обробки помилок
   • Дослідження файлових форматів

🔵 Secure Delete режим:
   • Видалення NDA документів
   • Очищення ПК перед передачею/продажем
   • Видалення персональних даних (GDPR)
   • Архівування з подальшим видаленням

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

ТЕХНІЧНІ ДЕТАЛІ:
================

Файлова структура:
  e:/Project/Fragment/
  ├── config.py              (оновлено: +OperationMode, +DeletionMode)
  ├── corruption_engine.py   (без змін, сумісна з новим)
  ├── secure_delete.py       (НОВИЙ: SecureShredder клас)
  ├── gui.py                 (оновлено: +динамічні контролі)
  ├── main.py                (без змін)
  ├── requirements.txt       (без змін)
  ├── README.md              (оновлено: документація Secure Delete)
  ├── SECURE_DELETE_GUIDE.md (НОВИЙ: детальна інструкція)
  └── test_modes.py          (НОВИЙ: автоматичні тести)

Залежності (без нових):
  • customtkinter - GUI
  • python-docx, openpyxl, python-pptx - Office метадані
  • Pillow - Image EXIF
  • pywin32 - Windows creation time (опціонально)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

ЗАПУСК:
=======

GUI версія:
  python main.py

Тести:
  python test_modes.py

Прямое використання SecureShredder:
  from secure_delete import SecureShredder
  shredder = SecureShredder(passes=3)  # DoD режим
  stats = shredder.shred_file("sensitive_file.pdf")

Прямое використання CorruptionEngine (як раніше):
  from corruption_engine import CorruptionEngine, CorruptionMode
  engine = CorruptionEngine(CorruptionMode.FULL)
  stats = engine.corrupt_file("test_file.zip")

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

ЛОГУВАННЯ:
==========

Обидва режими записують у fragment_corruptor.log:

Corruption приклад:
  2026-01-04 15:30:45 - INFO - Starting corruption process for 2 files
  2026-01-04 15:30:45 - INFO - Mode: Full Destruction (Header + Noise + Truncate)
  2026-01-04 15:30:46 - INFO - Created copy: C:/output/file [BROKEN].zip
  2026-01-04 15:30:46 - INFO - Header corrupted: 16 bytes
  2026-01-04 15:30:46 - INFO - Noise added: 5 bytes flipped
  2026-01-04 15:30:46 - INFO - File truncated: 42 bytes removed

Secure Delete приклад:
  2026-01-04 15:35:00 - INFO - SecureShredder ініціалізований з 3 проходами
  2026-01-04 15:35:00 - INFO - Starting secure deletion with 3 passes
  2026-01-04 15:35:05 - INFO - Прохід 1/3 завершено: Нулі (0x00)
  2026-01-04 15:35:10 - INFO - Прохід 2/3 завершено: Одиниці (0xFF)
  2026-01-04 15:35:15 - INFO - Прохід 3/3 завершено: Випадкові дані
  2026-01-04 15:35:15 - INFO - Ім'я змінено на: xKm9pQ2L
  2026-01-04 15:35:16 - INFO - Файл успішно анігільовано: secret.pdf

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

ПОРІВНЯННЯ:
===========

┌──────────────┬──────────────────┬──────────────────┐
│ Аспект       │ Corruption       │ Secure Delete    │
├──────────────┼──────────────────┼──────────────────┤
│ Тип          │ Пошкодження файл  │ Видалення файл  │
│ Результат    │ Неробочий копія  │ Файл видалено   │
│ Метадані     │ КОПІЮЮТЬСЯ       │ Затираються     │
│ Восстановл.  │ Можливо          │ Здебільшого ні  │
│ Швидкість    │ Швидко           │ Повільніше (3-7) │
│ Найкращих    │ Тестування       │ Реальне видал.  │
└──────────────┴──────────────────┴──────────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

ВЕРСІЯ: 2.0
ДАТА: 4 січня 2026
СТАТУС: Готово до використання ✅
"""

if __name__ == "__main__":
    print(__doc__)
